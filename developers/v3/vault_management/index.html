<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-developers docs-version-current docs-doc-page docs-doc-id-v3/vault_management" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Deploying and Managing a V3 Multi Strategy Vault | Yearn Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://docs.yearn.fi/img/YFILogoGradient.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.yearn.fi/img/YFILogoGradient.jpg"><meta data-rh="true" property="og:url" content="https://docs.yearn.fi/developers/v3/vault_management"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="Yearn Finance is a suite of products in Decentralized Finance (DeFi) that provides lending aggregation, yield generation, and insurance on the Ethereum blockchain."><meta data-rh="true" name="git-url" content="https://github.com/yearn/yearn-devdocs"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-developers-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-developers-current"><meta data-rh="true" property="og:title" content="Deploying and Managing a V3 Multi Strategy Vault | Yearn Docs"><meta data-rh="true" name="description" content="V3 makes it as simple as possible for anyone to deploy and manage their own Multi Strategy Vaults. No longer will Yearn be the only manager of Vaults, gate-keeping who can be a debt allocator, or what strategies should be added to a vault. Now, anyone can deploy, manage, and earn fees from their vision and preferences on everything from risk profile, fee model, decentralization, etc."><meta data-rh="true" property="og:description" content="V3 makes it as simple as possible for anyone to deploy and manage their own Multi Strategy Vaults. No longer will Yearn be the only manager of Vaults, gate-keeping who can be a debt allocator, or what strategies should be added to a vault. Now, anyone can deploy, manage, and earn fees from their vision and preferences on everything from risk profile, fee model, decentralization, etc."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.yearn.fi/developers/v3/vault_management"><link data-rh="true" rel="alternate" href="https://docs.yearn.fi/developers/v3/vault_management" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.yearn.fi/developers/v3/vault_management" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UNKNOWN-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Yearn Docs" href="/opensearch.xml">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.81a7a80b.css">
<script src="/assets/js/runtime~main.445aab89.js" defer="defer"></script>
<script src="/assets/js/main.bfcb87fb.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="YFI Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="YFI Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/getting-started/intro">User Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/developers/building-on-yearn">Dev Docs</a><a class="navbar__item navbar__link" href="/contributing/introduction">DAO Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://blog.yearn.fi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a href="https://discord.gg/b8ENPNqG5c" target="_blank" rel="noopener noreferrer" class="dropdown__link">Discord<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://x.com/yearnfi" target="_blank" rel="noopener noreferrer" class="dropdown__link">Twitter<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://t.me/yearnfinance/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Telegram<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://medium.com/iearn" target="_blank" rel="noopener noreferrer" class="dropdown__link">Medium<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://gov.yearn.fi" target="_blank" rel="noopener noreferrer" class="dropdown__link">Governance Forum<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://snapshot.org/#/veyfi.eth" target="_blank" rel="noopener noreferrer" class="dropdown__link">Snapshot Voting<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/yearn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://yearn.fi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-yearn-link" aria-label="yearn.fi"></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/developers/building-on-yearn">Building on Yearn</a><button aria-label="Collapse sidebar category &#x27;Building on Yearn&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/developers/v3/overview">yVaults</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/developers/v3/overview">yVaults v3</a><button aria-label="Collapse sidebar category &#x27;yVaults v3&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/v3/Integrating_v3">Integrating V3 Vaults</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/v3/strategy_writing_guide">Guide to creating V3 &quot;Tokenized Strategies&quot;</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/developers/v3/vault_management">Deploying and Managing a V3 Multi Strategy Vault</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/v3/vault_deployment">Manual Vault Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/v3/periphery">Periphery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/v3/protocol_fees">Protocol Fees</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a href="https://docs.yearn.fi/developers/addresses/v3-contracts" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">v3 Contract Addresses →<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a href="https://docs.yearn.fi/developers/smart-contracts/V3/" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">Smart Contracts →<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/developers/v2/getting-started">yVaults v2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/developers/v1/introduction">yVaults v1</a><button aria-label="Expand sidebar category &#x27;yVaults v1&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/v2/naming-convention">Naming Conventions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/developers/data-services/yearn-data">Yearn Data Services</a><button aria-label="Expand sidebar category &#x27;Yearn Data Services&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/developers/front-end-development">Front End Development</a><button aria-label="Expand sidebar category &#x27;Front End Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/developers/v2/yswaps">Other Stuff</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 divider"><hr></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/developers/addresses/">Token and Contract Addresses</a><button aria-label="Expand sidebar category &#x27;Token and Contract Addresses&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 divider"><hr></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/developers/smart-contracts/">Smart Contracts</a><button aria-label="Expand sidebar category &#x27;Smart Contracts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 divider"><hr></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/developers/security/">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deploying and Managing a V3 Multi Strategy Vault</h1></header>
<p>V3 makes it as simple as possible for anyone to deploy and manage their own Multi Strategy Vaults. No longer will Yearn be the only manager of Vaults, gate-keeping who can be a debt allocator, or what strategies should be added to a vault. Now, anyone can deploy, manage, and earn fees from their vision and preferences on everything from risk profile, fee model, decentralization, etc.</p>
<p>In V3 our multi strategy or &quot;Allocator Vaults&quot; are designed to be efficient 4626 compliant debt allocators that can have many different &quot;strategies&quot; attached to them and will direct funds to these strategies based on the vault&#x27;s management choice. The vaults are built to be &quot;plug and play&quot; meaning managers can simply deploy, add their strategies, and start the yield generation. But they also hold many customization factors, allowing different managers to differentiate themselves and experiment with different optionality.</p>
<p>Running your vault requires no need to know how to code. Anyone desiring to manage their strategies and allocations can simply deploy and run their vault.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="definitions">Definitions<a href="#definitions" class="hash-link" aria-label="Direct link to Definitions" title="Direct link to Definitions">​</a></h2>
<ul>
<li><strong>vault (allocator)</strong>: ERC-4626 compliant contract that accepts deposits, issues shares, and allocates funds to different strategies to earn yield.</li>
<li><strong>shares</strong>: A tokenized representation of a depositor&#x27;s share of the underlying balance of a vault.</li>
<li><strong>strategy</strong>: Any ERC-4626 compliant contract that can be added to an allocator vault that earns yield on an underlying asset.</li>
<li><strong>debt</strong>: The amount of the underlying asset that an allocator vault has sent to a strategy to earn yield.</li>
<li><strong>report</strong>: The function where a vault accounts for any profits or losses a strategy has accrued, charges applicable fees, and locks profit to be distributed to depositors.</li>
<li><strong>role_manager</strong>: The position given to an address in a vault that controls what other addresses have rights to call permissioned functions on the vault.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deployment">Deployment<a href="#deployment" class="hash-link" aria-label="Direct link to Deployment" title="Direct link to Deployment">​</a></h2>
<p>There are multiple ways to handle deployments of vaults. By far the simplest way to deploy your own multi-strategy vaults is by utilizing the pre-built <code>RoleManager</code> and <code>RoleManagerFactory</code> contracts.</p>
<p>The <code>RoleManagerFactory</code> can be used to deploy a full set of V3 periphery contracts including <code>Accountant</code>, <code>DebtAllocator</code>, <code>Registry</code> and <code>RoleManager</code> contracts and will configure them all automatically to make deployment and management as simple as possible while still allowing full customization where desired.</p>
<p>You can find the deployed <code>RoleManagerFactory</code> contract <a href="https://etherscan.io/address/0xca12459a931643BF28388c67639b3F352fe9e5Ce" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>You will only need three variables.</p>
<ol>
<li><code>projectName</code> : The name of your project i.e. &quot;Yearn&quot;</li>
<li><code>governance</code> : The main address to be in control of the vaults and RoleManager contract. This should be a fully trusted address.</li>
<li><code>management</code> :  Secondary address to manage lower risk more day to day needs of the vault such as debt allocations.</li>
</ol>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">projectName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Project Name&quot;</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Name of your project.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">governance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x69</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Address to be in charge of the project.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">management </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x420</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Address to help manage vaults.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Deploy a new RoleManager for your use case</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">address</span><span class="token plain"> myNewRoleManager </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> roleManagerFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newProject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    projectName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    governance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    management</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>RoleManager</code> contract deployed will then serve as the <code>role_manager</code> position on any multi-strategy vaults deployed for simple and programmatic setup of your vaults.</p>
<p>You can then use your new RoleManager contract to do one step deployments and setups of any new vaults.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin">address</span><span class="token plain"> newVault </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> myNewRoleManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newVault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    asset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    category</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vaultName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vaultSymbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>category</code> is used by the RoleManager to classify and store vaults which will allow multiple vault types that use the same underlying address to be deployed. The categorization can be anything a project manager desires or just set to <code>0</code> or any other constant for all.</p>
<p>Your new vault will now be deployed, with the Roles given out to each specified address, and Accountant hooked up to charge fees, and endorsed in your registry.</p>
<p>To learn more about how to customize your deployment setups and using the <code>RoleManager</code> contract view the <a href="/developers/smart-contracts/V3/Periphery/RoleManager">full spec</a></p>
<p>Alternatively you can manually deploy a vault directly from the factory and do a complete custom setup by following <a href="/developers/v3/vault_deployment">these instructions</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="miscellaneous">Miscellaneous<a href="#miscellaneous" class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous">​</a></h3>
<p>There are other options that a vault manager can set that are not necessary for the vault to function but may be desired for further customization.</p>
<ul>
<li><strong>minimum_total_idle</strong>: An amount specified in the underlying asset that the vault will force to remain free in the vault during debt updates to make servicing withdraws cheaper.</li>
<li><strong>profit_max_unlock_time</strong>: The time in which profits reported by the strategies will be distributed to depositors. This can be adjusted to match the current report cycle of the vault&#x27;s strategies to create a continuous stream of APY paid out to depositors.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-vault">Running the Vault<a href="#running-the-vault" class="hash-link" aria-label="Direct link to Running the Vault" title="Direct link to Running the Vault">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="strategy-management">Strategy Management<a href="#strategy-management" class="hash-link" aria-label="Direct link to Strategy Management" title="Direct link to Strategy Management">​</a></h3>
<p>The job of a vault is to manage debt between strategies that do the yield generation. 3 roles control what strategies are added to the vault, ADD_STRATEGY_MANAGER, REVOKE_STRATEGY_MANAGER, and FORCE_REVOKE_MANAGER.</p>
<p>A strategy can be any contract that has the needed <a href="https://github.com/yearn/yearn-vaults-v3/blob/master/contracts/VaultV3.vy#L39" target="_blank" rel="noopener noreferrer">4626 interface</a> for the vault to interact with it. This includes Tokenized Strategies, 3rd party 4626 vaults, and other  allocator vaults.</p>
<p>To add a strategy first call <code>vault.add_strategy(strategy_address)</code>.</p>
<p>Each strategy gets added with a default &#x27;max_debt&#x27; of 0. This means the MAX_DEBT_MANAGER will need to call <code>vault.update_max_debt_for_strategy(strategy, max_debt)</code>.</p>
<p>Once a strategy has been added and given a max_debt, the DEBT_MANAGER role can allocate funds.</p>
<p>To remove a strategy, first remove all the debt from the strategy and then call <code>vault.revoke_strategy(strategy)</code>.</p>
<p>If a strategy has issues and cannot pay all of its debt back <code>vault.force_revoke_strategy(strategy)</code> can be used to forcefully remove the strategy.</p>
<p>NOTE: Forcefully removing a strategy that still has debt will cause a loss to be recorded and a reduction of Price Per Share.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="debt-updates">Debt Updates<a href="#debt-updates" class="hash-link" aria-label="Direct link to Debt Updates" title="Direct link to Debt Updates">​</a></h3>
<p>The DEBT_MANAGER role is in charge of allocating funds between the strategies added to a vault.</p>
<p>By default the DEBT_MANAGER role is given to the <code>DebtAllocator</code> contract deployed by the <code>RoleManagerFactory</code> and is controlled by the <code>management</code> address. For a full explanation of the <code>DebtAllocator</code> visit the [full spech](LINK IT)</p>
<p>All debt updates are denominated in the underlying asset and are restricted by the <code>max_debt</code> for each strategy and the <code>minimum_total_idle</code> for the specific vault.</p>
<p>Debt updates will also respect the strategies specific <code>maxRedeem</code> and <code>maxDeposit</code>.</p>
<p>To deposit or withdraw vault funds from a strategy simply call <code>vault.update_debt(strategy, desired_debt)</code> where desired debt is the end amount denominated in the underlying asset that the strategy should have after the full debt update.</p>
<p>Debt updates also come with an optional <code>max_loss</code> parameter that is recommended to be used on debt decreases. It works just like the withdraw/redeem parameter of the same name and assures any losses realized on debt decreases are within the expected bounds.</p>
<p><strong>NOTE</strong>: If a strategy has unrealized losses you cannot lower its debt.</p>
<p><strong>NOTE</strong>: It is recommended to report a strategy&#x27;s gain before withdrawing 100% of debt from the strategy.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reporting">Reporting<a href="#reporting" class="hash-link" aria-label="Direct link to Reporting" title="Direct link to Reporting">​</a></h3>
<p>To properly record any profits/losses from a strategy, charge fees, and lock profits for distribution to depositors, the REPORTING_MANAGER will need to &quot;report&quot; for each strategy via <code>vault.process_report(strategy)</code>.</p>
<p>The RoleManager will give the REPORTING_MANAGER role by default to the global permissionless <code>Keeper</code>. This means anyone can call <code>process_report</code> on your vault unless otherwise set.</p>
<p>This function will trigger all necessary logic to record a strategy&#x27;s gain since the last report and begin distributing that profit to depositors over the vault&#x27;s specific <code>profit_max_unlock_time</code>.</p>
<p>NOTE: To charge fees you will need first to have added an &#x27;accountant&#x27; to your vault that will hold the fee logic and receive the fees that are charged.</p>
<p><strong>NOTE: All profit and loss calculations use the strategies &#x27;convertToAssets&#x27; function. If this function can be manipulated it can lead to incorrect profits or losses being recorded by the vault</strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="customization">Customization<a href="#customization" class="hash-link" aria-label="Direct link to Customization" title="Direct link to Customization">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="accountant">Accountant<a href="#accountant" class="hash-link" aria-label="Direct link to Accountant" title="Direct link to Accountant">​</a></h3>
<p>You will need to add a separate contract as the vault&#x27;s &#x27;accountant&#x27; to charge fees.</p>
<p><code>vault.set_accountant(accountant)</code></p>
<p>*If using the RoleManager/Factory this contract will be automatically deployed and setup during each subsequent vault deployment.</p>
<p>The accountant is called by the vault during every <code>report</code> with the strategy that is reporting and the gain or loss it&#x27;s reporting. The accountant will then return the total fees or refunds that should be charged by the vault during that report and paid to the accountant.</p>
<p>Accountants can hold any logic that vault managers want to dictate fees or simply charge normal performance or management fees. A ready-to-use Accountant can easily be used with any vault for those who wish just to charge standard fees.</p>
<p>See Here: <a href="https://github.com/yearn/vault-periphery/blob/master/contracts/accountants/Accountant.sol" target="_blank" rel="noopener noreferrer">https://github.com/yearn/vault-periphery/blob/master/contracts/accountants/Accountant.sol</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="depositwithdraw-limit-modules">Deposit/Withdraw Limit Modules<a href="#depositwithdraw-limit-modules" class="hash-link" aria-label="Direct link to Deposit/Withdraw Limit Modules" title="Direct link to Deposit/Withdraw Limit Modules">​</a></h4>
<p>Each vault comes with default deposit and withdraw limits that can be used for out of the box 4626 compliant functionality. However, these limits can also be completely customized for full programmability by adding a deposit_limit_module or withdraw_limit_module respectively.</p>
<p>These modules are stand-alone smart contracts similar to the accountant that if added will be used by the vault to enforce any custom deposit or withdraw limits.</p>
<p>This can be used to enforce a whitelist of depositors, minimum or maximum deposit sizes, liquidity constraints etc.</p>
<p><strong>Note</strong>: To set a deposit_limit_module the DEPOSIT_LIMIT_MANAGER will either need to use the optional <code>override</code> flag or first need to set the vaults default <code>deposit_limit</code> to uint256 max. And will not be able to change the <code>deposit_limit</code> without the same flag or unless the deposit_limit_module is removed and set to address(0).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="default-queue">Default Queue<a href="#default-queue" class="hash-link" aria-label="Direct link to Default Queue" title="Direct link to Default Queue">​</a></h4>
<p>Each vault has a <code>default_queue</code> based on the strategies added and removed from the vault. The <code>default_queue</code> is used to service withdraws when no custom queue is passed. This queue is simply ordered by the time when strategies were added: where the oldest strategy is at the beginning of the queue.</p>
<p>There is an optional parameter in <code>add_strategy</code> of <code>add_to_queue</code> that defaults to True, but can be set to False if you do not want to add the strategy to the <code>default_queue</code>.</p>
<p>If a different ordering is desired or management wants to remove a certain strategy from the default queue, the QUEUE_MANAGER role can set a new queue.</p>
<p><code>vault.set_default_queue(new_default_queue)</code></p>
<p>Where <code>new_default_queue</code> is an array of strategies with a max length of 10, in which all strategies are currently active in the vault.</p>
<p>The vaults QUEUE_MANAGER can also choose to not allow custom queues to be passed into the vault on withdraws at any time by turning on the &#x27;use_default_queue&#x27; flag by calling, <code>vault.set_use_default_queue(True)</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="good-to-know">Good to Know<a href="#good-to-know" class="hash-link" aria-label="Direct link to Good to Know" title="Direct link to Good to Know">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-tokens-not-to-use">What Tokens Not to Use<a href="#what-tokens-not-to-use" class="hash-link" aria-label="Direct link to What Tokens Not to Use" title="Direct link to What Tokens Not to Use">​</a></h3>
<p>There are certain tokens whose native behavior makes them incompatible with being the underlying asset of a vault and should be avoided.</p>
<p>A few examples of this are:</p>
<ul>
<li>Rebasing Tokens</li>
<li>Fee on Transfer</li>
<li>Reentrancy Tokens (ERC-777)</li>
</ul>
<p>Any token whose normal functionality breaks the ERC-20 standard may not be compatible with V3 vaults.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-10-29T21:27:27.000Z" itemprop="dateModified">Oct 29, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/developers/v3/strategy_writing_guide"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Guide to creating V3 &quot;Tokenized Strategies&quot;</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/developers/v3/vault_deployment"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Manual Vault Deployment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#definitions" class="table-of-contents__link toc-highlight">Definitions</a></li><li><a href="#deployment" class="table-of-contents__link toc-highlight">Deployment</a><ul><li><a href="#miscellaneous" class="table-of-contents__link toc-highlight">Miscellaneous</a></li></ul></li><li><a href="#running-the-vault" class="table-of-contents__link toc-highlight">Running the Vault</a><ul><li><a href="#strategy-management" class="table-of-contents__link toc-highlight">Strategy Management</a></li><li><a href="#debt-updates" class="table-of-contents__link toc-highlight">Debt Updates</a></li><li><a href="#reporting" class="table-of-contents__link toc-highlight">Reporting</a></li></ul></li><li><a href="#customization" class="table-of-contents__link toc-highlight">Customization</a><ul><li><a href="#accountant" class="table-of-contents__link toc-highlight">Accountant</a></li></ul></li><li><a href="#good-to-know" class="table-of-contents__link toc-highlight">Good to Know</a><ul><li><a href="#what-tokens-not-to-use" class="table-of-contents__link toc-highlight">What Tokens Not to Use</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>